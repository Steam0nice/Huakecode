document.addEventListener("DOMContentLoaded", () => {
  {
    if (localStorage.getItem("data-night")) {
      $(".Xc_action_item.mode .icon-1").addClass("active");
      $(".Xc_action_item.mode .icon-2").removeClass("active");
      $.getScript("/usr/themes/Xc/assets/js/Xc.bjxg.js");
    } else {
      $("html").removeAttr("data-night");
      $(".Xc_action_item.mode .icon-1").removeClass("active");
      $(".Xc_action_item.mode .icon-2").addClass("active");
    }
    $(".Xc_action_item.mode").on("click", () => {
      if (localStorage.getItem("data-night")) {
        $(".Xc_action_item.mode .icon-1").removeClass("active");
        $(".Xc_action_item.mode .icon-2").addClass("active");
        $("html").removeAttr("data-night");
        localStorage.removeItem("data-night");
      } else {
        $(".Xc_action_item.mode .icon-1").addClass("active");
        $(".Xc_action_item.mode .icon-2").removeClass("active");
        $("html").attr("data-night", "night");
        localStorage.setItem("data-night", "night");
        $.getScript("/usr/themes/Xc/assets/js/Xc.bjxg.js");
      }
    });
  }
  {
    if (!Xc.IS_MOBILE && Xc.DYNAMIC_BACKGROUND !== "off" && Xc.DYNAMIC_BACKGROUND && !Xc.WALLPAPER_BACKGROUND_PC) {
      $.getScript(window.Xc.THEME_URL + `assets/backdrop/${Xc.DYNAMIC_BACKGROUND}`);
    }
  }
  {
    $(".Xc_header_above-search .input").on("click", (e) => {
      e.stopPropagation();
      $(".Xc_header_above-search .result").addClass("active");
    });
    $(document).on("click", function () {
      $(".Xc_header_above-search .result").removeClass("active");
    });
  }
  {
    $(".Xc_dropdown").each(function (index, item) {
      const menu = $(this).find(".Xc_dropdown_menu");
      const trigger = $(item).attr("trigger") || "click";
      const placement = $(item).attr("placement") || $(this).height() || 60;
      menu.css("top", placement);
      if (trigger === "hover") {
        $(this).hover(
          () => $(this).addClass("active"),
          () => $(this).removeClass("active")
        );
      } else {
        $(this).on("click", function (e) {
          $(this).toggleClass("active");
          $(document).one("click", () => $(this).removeClass("active"));
          e.stopPropagation();
        });
        menu.on("click", (e) => e.stopPropagation());
      }
    });
  }
  {
    if ($(".Xc_aside_item.timelife").length) {
      let timelife = [
        { title: "今日已经过去", endTitle: "小时", num: 0, percent: "0%" },
        { title: "这周已经过去", endTitle: "天", num: 0, percent: "0%" },
        { title: "本月已经过去", endTitle: "天", num: 0, percent: "0%" },
        { title: "今年已经过去", endTitle: "个月", num: 0, percent: "0%" },
      ];
      {
        let nowDate = +new Date();
        let todayStartDate = new Date(new Date().toLocaleDateString()).getTime();
        let todayPassHours = (nowDate - todayStartDate) / 1000 / 60 / 60;
        let todayPassHoursPercent = (todayPassHours / 24) * 100;
        timelife[0].num = parseInt(todayPassHours);
        timelife[0].percent = parseInt(todayPassHoursPercent) + "%";
      }
      {
        let weeks = { 0: 7, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6 };
        let weekDay = weeks[new Date().getDay()];
        let weekDayPassPercent = (weekDay / 7) * 100;
        timelife[1].num = parseInt(weekDay);
        timelife[1].percent = parseInt(weekDayPassPercent) + "%";
      }
      {
        let year = new Date().getFullYear();
        let date = new Date().getDate();
        let month = new Date().getMonth() + 1;
        let monthAll = new Date(year, month, 0).getDate();
        let monthPassPercent = (date / monthAll) * 100;
        timelife[2].num = date;
        timelife[2].percent = parseInt(monthPassPercent) + "%";
      }
      {
        let month = new Date().getMonth() + 1;
        let yearPass = (month / 12) * 100;
        timelife[3].num = month;
        timelife[3].percent = parseInt(yearPass) + "%";
      }
      let htmlStr = "";
      timelife.forEach((item, index) => {
        htmlStr += `
                        <div class="item">
                            <div class="title">
                                ${item.title}
                                <span class="text">${item.num}</span>
                                ${item.endTitle}
                            </div>
                            <div class="progress">
                                <div class="progress-bar">
                                    <div class="progress-bar-inner progress-bar-inner-${index}" style="width: ${item.percent}"></div>
                                </div>
                                <div class="progress-percentage">${item.percent}</div>
                            </div>
                        </div>`;
      });
      $(".Xc_aside_item.timelife .Xc_aside_item-contain").html(htmlStr);
    }
  }
  {
    if ($(".Xc_aside_item.flatterer").length) {
      const arr = [
        "你昨天晚上又没回我信息，我却看见你的游戏在线，在我再一次孜孜不倦的骚扰你的情况下，你终于跟我说了一句最长的话“**你他妈是不是有病**”，我又陷入了沉思，这一定有什么含义，我想了很久，你竟然提到了我的妈妈，原来你已经想得那么长远了，想和我结婚见我的父母，我太感动了，真的。那你现在在干嘛，我好想你，我妈妈说她也很喜欢你。",
        "今天我观战了一天你和别人打游戏，**你们玩的很开心**；我给你发了200多条消息，你说没流量就不回；晚上发说说没有人爱你，我连滚带爬评论了句有“我在”，你把我拉黑了，我给你打电话也无人接听。对不起，我不该打扰你，我求求你再给我一次当好友的机会吧！",
        "我爸说再敢网恋就打断我的腿，幸好不是胳膊，这样我还能继续**和你打字聊天**，就算连胳膊也打断了，我的心里也会有你位置。",
        "你说你情侣头像是一个人用的，空间上锁是因为你不喜欢玩空间，情侣空间是和闺蜜开的，找你连麦时你说你在忙工作，每次聊天你都说在忙，你真是一个**上进的好女孩**，你真好，我好喜欢你！",
        "你跟他已经醒了吧？我今天捡垃圾挣了一百多，明天给你打过去。你快点休息吧，我明天叫你起床，给你点外卖买烟，给你点你最喜欢的奶茶。晚上我会继续去摆地摊的，你不用担心我，你床只有那么大睡不下三个。**你要好好照顾好自己，不要让他抢你被子**。我永远爱你！",
        "她三天没回我的消息了，在我孜孜不倦地骚扰下她终于舍得回我“**nmsl**”，我想这一定是有什么含义吧，噢！我恍然大悟原来是**尼美舒利颗粒**，她知道我有关节炎让我吃尼美舒利颗粒，她还是关心我的，但是又不想显现的那么热情。天啊！她好高冷，我好像更喜欢她了！",
        "你想我了吧？可以回我消息了吗？我买了万通筋骨贴，你**运动一个晚上腰很疼**吧？今晚早点回家，我炖了排骨汤，我永远在家等你。",
        "昨晚你和朋友打了一晚上游戏，你破天荒的给我看了战绩，虽然我看不懂但是我相信你一定是最厉害的、最棒的。我给你发了好多消息夸你，告诉你我多崇拜你，你回了我一句“**啥B**”，我翻来覆去思考这是什么意思，Sha[傻]，噢你是说我傻，那B就是Baby的意思了吧，原来你是在叫我**傻宝**，这么宠溺的语气，我竟一时不敢相信，其实你也是喜欢我的对吧。",
        "今天我还是照常给你发消息，汇报日常工作，你终于回了我四个字：“**嗯嗯，好的。**”。你开始愿意敷衍我了，我太感动了，受宠若惊。我愿意天天给你发消息，就算你天天骂我，我也不觉得烦。",
        "你昨天晚上又没回我的消息，在我孜孜不倦的骚扰下，你终于舍得回我了，你说“**滚**”，这其中一定有什么含义，我想了很久，滚是三点水，这代表你对我的思念也如**滚滚流水**一样汹涌，我感动哭了，不知道你现在在干嘛，我很想你。",
        "听说你想要一套化妆品，我算了算，明天我去工地上**搬一天砖**，就可以拿到200块钱，再加上我上个月攒下来的零花钱，刚好给你买一套迪奥。",
        "今天表白被拒绝了，她对我说能不能脱下裤子**撒泡尿照照自己**。当我脱下裤子，她咽了口水，说我们可以试一下。",
        "刚从派出所出来，原因前几天14号情人节，我想送你礼物，我去偷东西的时候被抓了。我本来想反抗，警察说了一句老实点别动，我立刻就放弃了反抗，因为我记得你说过，你喜欢**老实人**。",
        "疫情不能出门，现在是早上八点，你肯定饿了吧。我早起做好了早餐来到你小区，保安大哥不让进。我给你打了三个电话你终于接了“**有病啊，我还睡觉呢，你小区门口等着吧**”。啊，我高兴坏了！你终于愿意吃我做的早餐了，还让我等你，啊！啊！啊！好幸福噢！",
        "我存了两个月钱，给你买了一双**北卡蓝**，你对我说一句“谢谢”，我好开心。这是你第一次对我说两个字，以前你都只对我说滚。今天晚上逛**闲鱼**，看到了你把我送你的北卡蓝发布上去了。我想你一定是在考验我，再次送给你，给你一个惊喜，我爱你。",
        "昨天**你领完红包就把我删了**，我陷入久久地沉思。我想这其中一定有什么含义，原来你是在欲擒故纵，嫌我不够爱你。无理取闹的你变得更加可爱了，我会坚守我对你的爱的。你放心好啦！今天发工资了，发了1850，给你微信转了520，支付宝1314，还剩下16。给你发了很多消息你没回。剩下16块我在小卖部买了你爱吃的老坛酸菜牛肉面，给你寄过去了。希望你保护好食欲，我去上班了爱你~~",
        "在保安亭内看完了最新一集的梨泰院，曾经多么倔强的朴世路因为伊瑞给张大熙跪下了，亭外的树也许感受到了**我的悲伤**，枯了。我连树都保护不了，怎么保护你，或许保安才是真的需要被保护的吧。我难受，我想你。over",
        "难以言喻的下午。说不想你是假的，说爱你是真的。昨天他们骂**我是你的舔狗**，我不相信，因为我知道你肯定也是爱我的，你一定是在考验我对你的感情，只要我坚持下去你一定会被我的真诚所打动，加油！不过我要批评你一下，昨晚你说**去酒店跟人斗地主**，我寻思两个人也玩不了呀。算了，不想了，毕竟打牌是赌博行为，不太好。",
        "明天就周六了我知道你不上班，但是我怕你睡懒觉不吃早饭饿坏自己。我早晨4点去菜市场买了新鲜活鸡**给你炖鸡汤**，阿姨给我用箱子装了起来，我骑上我280买的电动车哼着小调回家，心想你一定会被我感动的，箱子半路开了，鸡跑了，拐到了一个胡同里，凌晨4点的胡同还有穿超短裙和大叔聊天的美女，不禁感叹这个世界变了，她问我找什么，…………。对不起，我爱你",
        "12点队长过来准时交班，出去的车辆按喇叭我也没听到，只因我在监控中看到了穿睡衣出来倒垃圾的你，**望你望的入神**不由的傻笑了起来，队长过来骂我扣了我一天工资。我委屈，想抱你。你送的泡面真好吃。",
        "今天的我排位输了好多把，我将这些事情分享给你，但是你一个字都没有讲，我在想你是不是在忙？我头痛欲裂，终于在我给你发了几十条消息之后，你回了我一个“**脑子是不是有病？**”，原来你还是关心我的，看到这句话，我的脑子一下就不疼了，今天也是爱你的一天。",
        "我存了半年的工资，给你买了一只LV，你对我说了一句“**你真好**”，我好开心，这是你第一次这么认可我，以前你都只对我说滚。今天晚上逛闲鱼，看到你把我送你的LV发布上去了。我想，你一定是在考验我，于是我用借呗里的钱把它买了下来，再次送给你，给你一个惊喜，我爱你。",
        "其实我每月工资6000，但我只给你转2000，你以为我给你了全部。才不是，我一共舔了3个啦，**我要舔的雨露均沾**，才不会把你当成唯一。",
        "昨天你把我拉黑了，我看着红色感叹号陷入了久久的沉思，我想这其中一定有什么含义？红色红色？我明白了！红色代表热情，你对我很热情，你想和我结婚，我愿意。",
        "今天你问我借了两千块钱，说要做个手术，你果然还是爱我的，**不是我的孩子，你不要**。 ",
        "中午你无故扇了我一巴掌，我握着你的手说“手怎么这么凉，都怪我没有照顾好你，一定要更加对你好”。",
        "我给你打了几通电话，你终于接了。听到了**你发出啊啊啊啊的声音**，你说你肚子痛，我想你一定是很难受吧。电话还有个男的对你说“来换个姿势”，一定是**在做理疗**了。期待你早日康复，我好担心。",
        "昨天晚上好冷，本来以为街上没人，结果刚刚**偷电动车**的时候被抓了，本来想反抗，但警察说了一句老实点别动，我立刻就放弃了抵抗，因为我记得你说过，你喜欢**老实人**。",
        "找你连麦时你说你在忙工作，每次聊天你都说在忙，你真是一个**上进的好女孩**，你真好，发现我越来越喜欢这样优秀的你。",
        "你从来没说过爱我，聊天记录搜索了一下“爱”，唯一的一条是：**你好像乡村爱情里的刘能啊**。",
        "今天好开心啊，和你一起在峡谷嬉戏，打完一波团战之后看到你在打大龙，残血的我跳过去直接被龙爪拍死，但这一刻我觉得好浪漫，**死在你的脚旁边，这是我离你最近的一次**。",
        "哥们，求你和她说句话吧，这样她就不会那么难过了。",
        "今天你把我的微信拉黑了，这下我终于解放了！以前我总担心太多消息会打扰你，现在我终于不用顾忌，不管我怎么给你发消息，都不会让你不开心了。等我**攒够5201314条**我就拿给你看，你一定会震惊得说不出话然后哭着说会爱我一辈子。哈哈。",
        "昨天你把我删了，我陷入了久久的沉思 。我想这其中一定有什么含义，你应该是欲擒故纵吧，嫌我不够爱你。突然觉得**无理取闹的你变得更加可爱**了，我会坚守我对你的爱的 你放心好啦！这么一想，突然对我俩的未来更有期望了呢。",
        "今天上班不是太忙，百无聊赖，又翻出了你的相片，看了又看。今天是我认识你的第302天，也是我爱你的第302天，可是这些你并不知道，也许**你知道了，也不会在意**吧。 此刻的我好想你！ ",
        "今天你跟我说我很丑，让我不要骚扰你了。我听了很高兴，小说里的主角都像你这样，最开始表现的很厌恶，但最后**总会被我的真心打动**。你现在有多讨厌我，以后就会有多爱我。嘻嘻。",
        "我坐在窗边给你发了99条消息，你终于肯回我了，你说“**发你妈啊**”，我一下子就哭了。原来努力真的有用，你已经开始考虑想见我的妈妈了，你也是挺喜欢我的。",
        "刚才我找你说话，你回了一个滚，我陷入了沉思，你还是如此的关心我，知道我腿受伤了，让我这样走，好感动！看来你还是爱我的！",
        "今天下雨了，我去你公司接你下班。看见我你不耐烦的说“**烦不烦啊，不要再找我了**”，一头冲进雨里就跑开了。我心里真高兴啊，你宁愿自己淋雨，都不愿让我也淋湿一点，你果然还是爱我的。",
        "晚上和你聊天，10点钟不到，你就说“**困了，去睡觉了**”。现在凌晨1点钟，看到你给他的朋友圈点赞评论，约他明天去吃火锅，一定是你微信被盗了吧。",
        "今天我主动给你发了游戏邀请，邀请你和我单挑安琪拉，虽然我安琪拉很菜，可是为了和你打游戏，我还是毅然决然给你发了邀请。你说你不接受，你在打其他游戏。联想到我自己很菜，我突然明白，原来你还是在乎我的，只是不想一遍遍连招一套的在泉水送我走。我再一次感动哭了，因此，我好像更喜欢你了，你可真是一个宝藏男孩！",
        "你的头像是一个女孩子左手边牵着一条秋田犬，犬=狗，而**我是一条舔狗**。是不是代表你的小手在牵着我呢？",
        "今天发工资了，我一个月工资3000，你猜我会给你多少，是不是觉得我会给你2500，自己留500吃饭？你想多了，我3000都给你，因为厂里包吃包住。",
        "昨天就为你充了710点卷，虽然知道你不会玩不知去向，但你说好看，你刚才说小号想要还想要一个，爱你的我还是满心欢喜的把剩下的100元伙食费又给你充了710，然后看到你小号并没有买，而是你送给了你的一个弟弟，你对弟弟真好，好有爱心，我感觉对你陷得很深了。",
        "今天我给你发消息，你回复我“**nmsl**”，我想了半天才知道你是在夸我，原来是**你美死了**，你嘴真甜，我爱你。",
        "你说你想买口红，今天我去了叔叔的口罩厂做了一天的打包。拿到了两百块钱，加上我这几天**省下的钱刚好能给你买一根小金条**。即没有给我自己剩下一分钱，但你不用担心，因为厂里包吃包住。对了打包的时候，满脑子都是你，想着你哪天突然就接受我的橄榄枝了呢。而且今天我很棒呢，主管表扬我很能干，其实也有你的功劳啦，是你给了我无穷的力量。今天我比昨天多想你一点，比明天少想你一点。",
        "在我一如既往的每天跟她问早安的时候，她今天终于回我了。我激动地问她我是不是今天第一个跟她说话的人，她说不是，是**她男朋友把她叫起来退房**的。",
        "听说你朋友说今天出门了，我打扮成精神小伙来找你，没想到你竟然对我说“**给我爬，别过来**”我当场就哭了，原来真心真的会感动人，你一定是知道，穿豆豆鞋走路脚会很累，让我爬是因为这样不会累着脚，其实你是喜欢我的吧",
        "今天把你的备注改成了「**对方正在输入...**」，这样我就知道你不是不想回我，刚又给你发了消息，看到你在思考怎么回我，我就知道你和我一样，心里有我。",
        "今天在楼上窗户上看见你和他在公园里接吻，我看见哭了出来，并打电话给你，想问问你为什么？但你说怎么了，声音是那么好听。于是我说“**以后你和他接吻的时候，能不能用我送给你的口红啊？**”",
        "我退了无关紧要的群，唯独这个群我没有退，因为这里有一个对我来说很特别的女孩子，我们不是好友，**我每天只能通过群名片看看她**，虽然一张照片也看不到，我也知足了，我不敢说她的名字，但我知道她是群里面最美的女孩子，她说我们这样会距离产生美~ 我想想发现她说的挺对的，我心里很开心。",
        "今天早上我告诉你我想你了，你没理我。今天中午我给你打电话，你不接，打第二个你就关机。晚上我在你公司楼下等你，你对我说的第一句话就是滚“**滚，别烦我，别浪费时间了**”，我真的好感动，你居然为我考虑了，怕我浪费时间。呜呜呜，这是我爱你的第74天。",
        "我坐在窗边给你发了99条消息，你终于肯回我了你说“**发你妈啊**”，我一下子就哭了，原来努力真的有用，你已经开始考虑想见我的妈妈了，你其实也是挺喜欢我的。",
        "你一个小时没回我的消息，在我孜孜不倦地骚扰下你终于舍得回我了“**在做爱**”，这其中一定有什么含义，我想了很久，“在做爱”这简简单单的三个字肯定是三句话，分别是**我在忙、做你女朋友、我爱你**，想到这里我不禁流下了眼泪，我这么长时间的喜欢没有白费，不知道你现在忙干嘛，但我很想你。",
        "最近我暗恋的女生每天都和不同的男生约会，我想总有一天会轮到我，我问她什么时候能见见我？她说**下辈子吧**。她真好，下辈子还要和我在一起。",
        "你好像从来没有对我说过晚安，我在我们的聊天记录里搜索了关键字：“晚安”，你说过一次：**我早晚安排人弄死你**。",
      ];
      const random = (min, max) => {
        min = Math.ceil(min);
        max = Math.floor(max);
        return Math.floor(Math.random() * (max - min + 1)) + min;
      };
      const toggle = () => {
        $(".Xc_aside_item.flatterer .content").html(arr[random(0, arr.length - 1)].replace(/\*\*(.*?)\*\*/g, "<mark>$1</mark>"));
        $(".Xc_aside_item.flatterer .content").attr("class", "content type" + random(1, 6));
      };
      toggle();
      $(".Xc_aside_item.flatterer .change").on("click", () => toggle());
    }
  }
  {
    if ($(".Xc_comment_respond").length) {
      const respond = $(".Xc_comment_respond");
      $(".Xc_comment_reply").on("click", function () {
        const coid = $(this).attr("data-coid");
        const item = $("#" + $(this).attr("data-id"));
        respond.find(".Xc_comment_respond-form").attr("data-coid", coid);
        item.append(respond);
        $(".Xc_comment_respond-type .item[data-type='text']").click();
        $(".Xc_comment_cancle").show();
        window.scrollTo({
          top: item.offset().top - $(".Xc_header").height() - 15,
          behavior: "smooth",
        });
      });
      $(".Xc_comment_cancle").on("click", function () {
        respond.find(".Xc_comment_respond-form").removeAttr("data-coid");
        $(".Xc_comment_cancle").hide();
        $(".Xc_comment_title").after(respond);
        $(".Xc_comment_respond-type .item[data-type='text']").click();
        window.scrollTo({
          top: $(".Xc_comment").offset().top - $(".Xc_header").height() - 15,
          behavior: "smooth",
        });
      });
    }
  }
  {
    if ($(".Xc_comment").length) {
      let isSubmit = false;
      $(".Xc_comment_respond-form").on("submit", function (e) {
        e.preventDefault();
        const action = $(".Xc_comment_respond-form").attr("action") + "?time=" + +new Date();
        const type = $(".Xc_comment_respond-form").attr("data-type");
        const parent = $(".Xc_comment_respond-form").attr("data-coid");
        const author = $(".Xc_comment_respond-form .head input[name='author']").val();
        const _ = $(".Xc_comment_respond-form input[name='_']").val();
        const mail = $(".Xc_comment_respond-form .head input[name='mail']").val();
        const url = $(".Xc_comment_respond-form .head input[name='url']").val();
        let text = $(".Xc_comment_respond-form .body textarea[name='text']").val();
        if (author.trim() === "") return Qmsg.info("请输入昵称！");
        if (!/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(mail)) return Qmsg.info("请输入正确的邮箱！");
        if (type === "text" && text.trim() === "") return Qmsg.info("请输入评论内容！");
        if (type === "draw") {
          const txt = $("#Xc_comment_draw")[0].toDataURL("image/webp", 0.1);
          text = "{!{" + txt + "}!} ";
        }
        if (isSubmit) return;
        isSubmit = true;
        $(".Xc_comment_respond-form .foot .submit button").html("发送中...");
        $.ajax({
          url: action,
          type: "POST",
          data: { author, mail, text, parent, url, _ },
          dataType: "text",
          success(res) {
            let arr = [],
              str = "";
            arr = $(res).contents();
            Array.from(arr).forEach((_) => {
              if (_.parentNode.className === "container") str = _;
            });
            if (!/Xc/.test(res)) {
              Qmsg.warning(str.textContent.trim() || "");
              isSubmit = false;
              $(".Xc_comment_respond-form .foot .submit button").html("发表评论");
            } else {
              window.location.reload();
            }
          },
          error() {
            isSubmit = false;
            $(".Xc_comment_respond-form .foot .submit button").html("发表评论");
            Qmsg.warning("发送失败！请刷新重试！");
          },
        });
      });
    }
  }
  {
    $(".comment_list_item .term .content .user .author a").each((index, item) => $(item).attr("target", "_blank"));
  }
  {
    $(".Xc_comment .Xc_pagination a").each((index, item) => {
      const href = $(item).attr("href");
      if (href && href.includes("#")) {
        $(item).attr("href", href.replace("#comments", "?scroll=Xc_comment"));
      }
    });
  }
  {
    if (Xc.DOCUMENT_TITLE) {
      const TITLE = document.title;
      document.addEventListener("visibilitychange", () => {
        if (document.visibilityState === "hidden") {
          document.title = Xc.DOCUMENT_TITLE;
        } else {
          document.title = TITLE;
        }
      });
    }
  }
  {
    $(".Xc_header_above-slideicon").on("click", function () {
      $(".Xc_header_searchout").removeClass("active");
      if ($(".Xc_header_slideout").hasClass("active")) {
        $("body").css("overflow", "");
        $(".Xc_header_mask").removeClass("active slideout");
        $(".Xc_header_slideout").removeClass("active");
      } else {
        $("body").css("overflow", "hidden");
        $(".Xc_header_mask").addClass("active slideout");
        $(".Xc_header_slideout").addClass("active");
      }
    });
  }
  {
    $(".Xc_header_above-searchicon").on("click", function () {
      $(".Xc_header_slideout").removeClass("active");
      if ($(".Xc_header_searchout").hasClass("active")) {
        $("body").css("overflow", "");
        $(".Xc_header_mask").removeClass("active slideout");
        $(".Xc_header_searchout").removeClass("active");
      } else {
        $("body").css("overflow", "hidden");
        $(".Xc_header_mask").addClass("active");
        $(".Xc_header_searchout").addClass("active");
      }
    });
  }
  {
    $(".Xc_header_mask").on("click", function () {
      $("body").css("overflow", "");
      $(".Xc_header_mask").removeClass("active slideout");
      $(".Xc_header_searchout").removeClass("active");
      $(".Xc_header_slideout").removeClass("active");
    });
  }
  {
    $(".Xc_header_slideout-menu .current").parents(".panel-body").show().siblings(".panel").addClass("in");
    $(".Xc_header_slideout-menu .panel").on("click", function () {
      const panelBox = $(this).parent().parent();
      panelBox.find(".panel").not($(this)).removeClass("in");
      panelBox.find(".panel-body").not($(this).siblings(".panel-body")).stop().hide("fast");
      $(this).toggleClass("in").siblings(".panel-body").stop().toggle("fast");
    });
  }
  {
    const getRunTime = () => {
      const birthDay = new Date(Xc.BIRTHDAY);
      const today = +new Date();
      const timePast = today - birthDay.getTime();
      let day = timePast / (1000 * 24 * 60 * 60);
      let dayPast = Math.floor(day);
      let hour = (day - dayPast) * 24;
      let hourPast = Math.floor(hour);
      let minute = (hour - hourPast) * 60;
      let minutePast = Math.floor(minute);
      let second = (minute - minutePast) * 60;
      let secondPast = Math.floor(second);
      day = String(dayPast).padStart(2, 0);
      hour = String(hourPast).padStart(2, 0);
      minute = String(minutePast).padStart(2, 0);
      second = String(secondPast).padStart(2, 0);
      $(".Xc_run__day").html(day);
      $(".Xc_run__hour").html(hour);
      $(".Xc_run__minute").html(minute);
      $(".Xc_run__second").html(second);
    };
    if (Xc.BIRTHDAY && /(\d{4})\/(\d{1,2})\/(\d{1,2}) (\d{1,2})\:(\d{1,2})\:(\d{1,2})/.test(Xc.BIRTHDAY)) {
      getRunTime();
      setInterval(getRunTime, 1000);
    }
  }
  {
    if($('.Xc_owo_contain').length&&$('.Xc_owo_target').length){
        $.ajax({
        url:window.Xc.THEME_URL+'assets/json/Xc.owo.json',
        dataType:'json',
        success(res){
        let barStr='';
        let scrollStr='';
        for(let key in res){
        const item=res[key];
        barStr+=`<div class="item" data-type="${key}">${key}</div>`;
        scrollStr+=`<ul class="scroll" data-type="${key}">
        ${item.map(_ => `<li class="item"data-text="${_.data}">${key==='颜文字'?`${_.icon}`:`<img class="lazyload" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjUyOTQ1MjE4NjI3IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjMzNTEiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTU2My4yIDQ2My4zTDY3NyA1NDBjMS43IDEuMiAzLjcgMS44IDUuOCAxLjggMC43IDAgMS40LTAuMSAyLTAuMiAyLjctMC41IDUuMS0yLjEgNi42LTQuNGwyNS4zLTM3LjhjMS41LTIuMyAyLjEtNS4xIDEuNi03LjhzLTIuMS01LjEtNC40LTYuNmwtNzMuNi00OS4xIDczLjYtNDkuMWMyLjMtMS41IDMuOS0zLjkgNC40LTYuNiAwLjUtMi43IDAtNS41LTEuNi03LjhsLTI1LjMtMzcuOGExMC4xIDEwLjEgMCAwIDAtNi42LTQuNGMtMC43LTAuMS0xLjMtMC4yLTItMC4yLTIuMSAwLTQuMSAwLjYtNS44IDEuOGwtMTEzLjggNzYuNmMtOS4yIDYuMi0xNC43IDE2LjQtMTQuNyAyNy41IDAuMSAxMSA1LjUgMjEuMyAxNC43IDI3LjR6TTM4NyAzNDguOGgtNDUuNWMtNS43IDAtMTAuNCA0LjctMTAuNCAxMC40djE1My4zYzAgNS43IDQuNyAxMC40IDEwLjQgMTAuNEgzODdjNS43IDAgMTAuNC00LjcgMTAuNC0xMC40VjM1OS4yYzAtNS43LTQuNy0xMC40LTEwLjQtMTAuNHogbTMzMy44IDI0MS4zbC00MS0yMGExMC4zIDEwLjMgMCAwIDAtOC4xLTAuNWMtMi42IDAuOS00LjggMi45LTUuOSA1LjQtMzAuMSA2NC45LTkzLjEgMTA5LjEtMTY0LjQgMTE1LjItNS43IDAuNS05LjkgNS41LTkuNSAxMS4ybDMuOSA0NS41YzAuNSA1LjMgNSA5LjUgMTAuMyA5LjVoMC45Yzk0LjgtOCAxNzguNS02Ni41IDIxOC42LTE1Mi43IDIuNC01IDAuMy0xMS4yLTQuOC0xMy42eiBtMTg2LTE4Ni4xYy0xMS45LTQyLTMwLjUtODEuNC01NS4yLTExNy4xLTI0LjEtMzQuOS01My41LTY1LjYtODcuNS05MS4yLTMzLjktMjUuNi03MS41LTQ1LjUtMTExLjYtNTkuMi00MS4yLTE0LTg0LjEtMjEuMS0xMjcuOC0yMS4xaC0xLjJjLTc1LjQgMC0xNDguOCAyMS40LTIxMi41IDYxLjctNjMuNyA0MC4zLTExNC4zIDk3LjYtMTQ2LjUgMTY1LjgtMzIuMiA2OC4xLTQ0LjMgMTQzLjYtMzUuMSAyMTguNCA5LjMgNzQuOCAzOS40IDE0NSA4Ny4zIDIwMy4zIDAuMSAwLjIgMC4zIDAuMyAwLjQgMC41bDM2LjIgMzguNGMxLjEgMS4yIDIuNSAyLjEgMy45IDIuNiA3My4zIDY2LjcgMTY4LjIgMTAzLjUgMjY3LjUgMTAzLjUgNzMuMyAwIDE0NS4yLTIwLjMgMjA3LjctNTguNyAzNy4zLTIyLjkgNzAuMy01MS41IDk4LjEtODUgMjcuMS0zMi43IDQ4LjctNjkuNSA2NC4yLTEwOS4xIDE1LjUtMzkuNyAyNC40LTgxLjMgMjYuNi0xMjMuOCAyLjQtNDMuNi0yLjUtODctMTQuNS0xMjl6IG0tNjAuNSAxODEuMWMtOC4zIDM3LTIyLjggNzItNDMgMTA0LTE5LjcgMzEuMS00NC4zIDU4LjYtNzMuMSA4MS43LTI4LjggMjMuMS02MSA0MS05NS43IDUzLjQtMzUuNiAxMi43LTcyLjkgMTkuMS0xMTAuOSAxOS4xLTgyLjYgMC0xNjEuNy0zMC42LTIyMi44LTg2LjJsLTM0LjEtMzUuOGMtMjMuOS0yOS4zLTQyLjQtNjIuMi01NS4xLTk3LjctMTIuNC0zNC43LTE4LjgtNzEtMTkuMi0xMDcuOS0wLjQtMzYuOSA1LjQtNzMuMyAxNy4xLTEwOC4yIDEyLTM1LjggMzAtNjkuMiA1My40LTk5LjEgMzEuNy00MC40IDcxLjEtNzIgMTE3LjItOTQuMSA0NC41LTIxLjMgOTQtMzIuNiAxNDMuNC0zMi42IDQ5LjMgMCA5NyAxMC44IDE0MS44IDMyIDM0LjMgMTYuMyA2NS4zIDM4LjEgOTIgNjQuOCAyNi4xIDI2IDQ3LjUgNTYgNjMuNiA4OS4yIDE2LjIgMzMuMiAyNi42IDY4LjUgMzEgMTA1LjEgNC42IDM3LjUgMi43IDc1LjMtNS42IDExMi4zeiIgcC1pZD0iMzM1MiIgZmlsbD0iI2JmYmZiZiI+PC9wYXRoPjwvc3ZnPg==" data-src="${ window.Xc.THEME_URL + _.icon }" alt="${_.data}"/>`}</li>`).join('')}
        </ul>
        `;}
        $('.Xc_owo_contain').html(`
    <div class="seat"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" style="height: 23px;line-height: 23px;background: #bec6d4c9;opacity: .8;border-radius: 50px;width: 23px;"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm141.4 389.4c-37.8 37.8-88 58.6-141.4 58.6s-103.6-20.8-141.4-58.6S48 309.4 48 256s20.8-103.6 58.6-141.4S194.6 56 248 56s103.6 20.8 141.4 58.6S448 202.6 448 256s-20.8 103.6-58.6 141.4zM328 224c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm-160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm194.4 64H133.6c-8.2 0-14.5 7-13.5 15 7.5 59.2 58.9 105 121.1 105h13.6c62.2 0 113.6-45.8 121.1-105 1-8-5.3-15-13.5-15z"></path></svg></div>
    <div class="box">
    ${scrollStr}
    <div class="bar">${barStr}</div>
    </div>
    `);
    $(document).on('click',function(){
    $('.Xc_owo_contain .box').stop().slideUp('fast');});
    $('.Xc_owo_contain .seat').on('click',function(e){
        e.stopPropagation();
        $(this).siblings('.box').stop().slideToggle('fast');});
    $('.Xc_owo_contain .box .bar .item').on('click',function(e){
        e.stopPropagation();
    $(this).addClass('active').siblings().removeClass('active');
        const scrollIndx='.Xc_owo_contain .box .scroll[data-type="'+$(this).attr('data-type')+'"]';$(scrollIndx).show().siblings('.scroll').hide();});
    $('.Xc_owo_contain .scroll .item').on('click',function(){
        const text=$(this).attr('data-text');$('.Xc_owo_target').insertContent(text);});
    $('.Xc_owo_contain .box .bar .item').first().click();}});
    }
  }
  {
    const $comment = document.querySelector('.Xc_comment');
    const $header = document.querySelector('.Xc_header');
      $('.transfer').on('click', function() {
      const top = $comment.offsetTop - $header.offsetHeight - 15;
      window.scrollTo({
      top, behavior: 'smooth'
    });
    });
    }
  {
    let motto = Xc.MOTTO;
    if (!motto) motto = "有钱终成眷属，没钱亲眼目睹";
    if (motto.includes("http")) {
      $.ajax({
        url: motto,
        dataType: "text",
        success: (res) => $(".Xc_motto").html(res),
      });
    } else {
      $(".Xc_motto").html(motto);
    }
  }
  {
    if (!window.Xc.IS_MOBILE) {
      let flag = true;
      const handleHeader = (diffY) => {
        if (window.pageYOffset >= $(".Xc_header").height() && diffY <= 0) {
          if (flag) return;
          $(".Xc_header").addClass("active");
          $(".Xc_aside .Xc_aside_item:last-child").css("top", $(".Xc_header").height() - 60 + 80);
          flag = true;
        } else {
          if (!flag) return;
          $(".Xc_header").removeClass("active");
          $(".Xc_aside .Xc_aside_item:last-child").css("top", $(".Xc_header").height() + 20);
          flag = false;
        }
      };
      let Y = window.pageYOffset;
      handleHeader(Y);
      let _last = Date.now();
      document.addEventListener("scroll", () => {
        let _now = Date.now();
        if (_now - _last > 15) {
          handleHeader(Y - window.pageYOffset);
          Y = window.pageYOffset;
        }
        _last = _now;
      });
      window.addEventListener('scroll', function() {
        var header = document.querySelector("header");
        header.classList.toggle("Xc_slid", window.scrollY > 100)
    });
    }
  }
});
function fn_qqinfo() {
    var qq_num = $('#author').val();
    if (qq_num) {
        if (!isNaN(qq_num)) {
            $.ajax({
                url: "/usr/themes/Xc/core/qq_info.php",
                type: "POST",  
                data: {
                    qq: qq_num,
                },
                async: true,
                dataType: "json",
                success: function(data) {
                    $("#mail").val(qq_num + '@qq.com');
                    $('#comment').focus();
                    if (data == null) {
                        $("#author").val('');
                    } else {
                        $("#author").val(data.name == "" ? '' : data.name);
                      $('div.ajax-user-avatar img').attr('src',data.qqtx);
                    }
                },
                error: function(err) {
                    $("#author").val('');
                    $("#mail").val(qq_num + '@qq.com');
                    $('#comment').focus();
                }
            });
        }
    }
  }
